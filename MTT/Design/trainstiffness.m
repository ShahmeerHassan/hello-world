
% average diameters
d = [44.82857143 29.76052222] ./ 1000;

L = [0.71 0.52009];

J = pi.*d.^4 /32;
Gshear = 8.25e10;
kti = Gshear.*J./L; % torsional stiffnesses

w = sqrt(kti ./ J);
w = (w / (2 * pi)) * 60

rho_gear = 8000;

G = [
    3.400
    1.882
    1.47
    1.24
    1.00
    2.20
    1.82
    1.56
    1.33
    0.82
    2.33
    1.82
    1.44
    1.18
    0.83]';

d = [51.96
183.60
51.96
176.67
78.52
147.80
88.33
129.90
98.15
121.24
107.96
107.96
143.18
69.28
41.57
46.19
115.47
60.62
133.37
68.70
125.29
73.90
115.47
77.94
103.92
98.15
80.83
96.99
73.90
46.19
58.89
117.78
60.62
141.45
68.70
125.29
83.14
119.51
88.33
103.92
103.92
86.60
106.23
73.90
46.19
]';

b = [31.2
    47.1
    53.0
    58.9
    64.8
    36.4
    41.2
    44.3
    46.8
    58.9
    36.4
    41.2
    49.9
    53.0
    62.4
    ];

d([1:2,13:15, 16:17, 28:30, 31:32, 43:45])=[];
d1 = [];
d2 = [];
for i=1:length(d)
    if mod(i,2) ~= 0
        % odd
        d1 = [d1; d(i)];
    else
        % even
        d2 = [d2; d(i)];
    end
end
d1 = d1 ./ 1000;
d2 = d2 ./ 1000;
b = b ./ 1000;

m1 = rho_gear .* pi .* (d1./2).^2 .* b;
m2 = rho_gear .* pi .* (d2./2).^2 .* b;

I1 = 0.5 .* m1 .* (d1./2).^2;
I2 = 0.5 .* m1 .* (d2./2).^2;

kt = 1 ./ ( (1./kti(1)) + (1./(G.^2 .* kti(2))) );

omega = sqrt(  (kt.* I1' + G.^2 .* I2') ./ (G.^2 .* I1' .* I2')  )';
omega = (omega / (2 * pi)) * 60;
[mino, idx] = min(omega)
